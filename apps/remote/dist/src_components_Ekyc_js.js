"use strict";
(self["webpackChunknextjs_host_react_remote_remote"] = self["webpackChunknextjs_host_react_remote_remote"] || []).push([["src_components_Ekyc_js"],{

/***/ "./node_modules/@mui/icons-material/Fingerprint.js":
/*!*********************************************************!*\
  !*** ./node_modules/@mui/icons-material/Fingerprint.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {



var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");
Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;
var _createSvgIcon = _interopRequireDefault(__webpack_require__(/*! ./utils/createSvgIcon */ "./node_modules/@mui/icons-material/utils/createSvgIcon.js"));
var _jsxRuntime = __webpack_require__(/*! react/jsx-runtime */ "./node_modules/react/jsx-runtime.js");
var _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
  d: "M17.81 4.47c-.08 0-.16-.02-.23-.06C15.66 3.42 14 3 12.01 3c-1.98 0-3.86.47-5.57 1.41-.24.13-.54.04-.68-.2-.13-.24-.04-.55.2-.68C7.82 2.52 9.86 2 12.01 2c2.13 0 3.99.47 6.03 1.52.25.13.34.43.21.67-.09.18-.26.28-.44.28zM3.5 9.72c-.1 0-.2-.03-.29-.09-.23-.16-.28-.47-.12-.7.99-1.4 2.25-2.5 3.75-3.27C9.98 4.04 14 4.03 17.15 5.65c1.5.77 2.76 1.86 3.75 3.25.16.22.11.54-.12.7-.23.16-.54.11-.7-.12-.9-1.26-2.04-2.25-3.39-2.94-2.87-1.47-6.54-1.47-9.4.01-1.36.7-2.5 1.7-3.4 2.96-.08.14-.23.21-.39.21zm6.25 12.07c-.13 0-.26-.05-.35-.15-.87-.87-1.34-1.43-2.01-2.64-.69-1.23-1.05-2.73-1.05-4.34 0-2.97 2.54-5.39 5.66-5.39s5.66 2.42 5.66 5.39c0 .28-.22.5-.5.5s-.5-.22-.5-.5c0-2.42-2.09-4.39-4.66-4.39-2.57 0-4.66 1.97-4.66 4.39 0 1.44.32 2.77.93 3.85.64 1.15 1.08 1.64 1.85 2.42.19.2.19.51 0 .71-.11.1-.24.15-.37.15zm7.17-1.85c-1.19 0-2.24-.3-3.1-.89-1.49-1.01-2.38-2.65-2.38-4.39 0-.28.22-.5.5-.5s.5.22.5.5c0 1.41.72 2.74 1.94 3.56.71.48 1.54.71 2.54.71.24 0 .64-.03 1.04-.1.27-.05.53.13.58.41.05.27-.13.53-.41.58-.57.11-1.07.12-1.21.12zM14.91 22c-.04 0-.09-.01-.13-.02-1.59-.44-2.63-1.03-3.72-2.1-1.4-1.39-2.17-3.24-2.17-5.22 0-1.62 1.38-2.94 3.08-2.94 1.7 0 3.08 1.32 3.08 2.94 0 1.07.93 1.94 2.08 1.94s2.08-.87 2.08-1.94c0-3.77-3.25-6.83-7.25-6.83-2.84 0-5.44 1.58-6.61 4.03-.39.81-.59 1.76-.59 2.8 0 .78.07 2.01.67 3.61.1.26-.03.55-.29.64-.26.1-.55-.04-.64-.29-.49-1.31-.73-2.61-.73-3.96 0-1.2.23-2.29.68-3.24 1.33-2.79 4.28-4.6 7.51-4.6 4.55 0 8.25 3.51 8.25 7.83 0 1.62-1.38 2.94-3.08 2.94s-3.08-1.32-3.08-2.94c0-1.07-.93-1.94-2.08-1.94s-2.08.87-2.08 1.94c0 1.71.66 3.31 1.87 4.51.95.94 1.86 1.46 3.27 1.85.27.07.42.35.35.61-.05.23-.26.38-.47.38z"
}), 'Fingerprint');
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/@mui/icons-material/PhotoCamera.js":
/*!*********************************************************!*\
  !*** ./node_modules/@mui/icons-material/PhotoCamera.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {



var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");
Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;
var _createSvgIcon = _interopRequireDefault(__webpack_require__(/*! ./utils/createSvgIcon */ "./node_modules/@mui/icons-material/utils/createSvgIcon.js"));
var _jsxRuntime = __webpack_require__(/*! react/jsx-runtime */ "./node_modules/react/jsx-runtime.js");
var _default = (0, _createSvgIcon.default)([/*#__PURE__*/(0, _jsxRuntime.jsx)("circle", {
  cx: "12",
  cy: "12",
  r: "3.2"
}, "0"), /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
  d: "M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"
}, "1")], 'PhotoCamera');
exports["default"] = _default;

/***/ }),

/***/ "./src/components/Ekyc.js":
/*!********************************!*\
  !*** ./src/components/Ekyc.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Ekyc)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _mui_material_Button__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @mui/material/Button */ "./node_modules/@mui/material/Button/Button.js");
/* harmony import */ var _mui_material_IconButton__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @mui/material/IconButton */ "./node_modules/@mui/material/IconButton/IconButton.js");
/* harmony import */ var _mui_icons_material_PhotoCamera__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @mui/icons-material/PhotoCamera */ "./node_modules/@mui/icons-material/PhotoCamera.js");
/* harmony import */ var _mui_material_TextField__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @mui/material/TextField */ "./node_modules/@mui/material/TextField/TextField.js");
/* harmony import */ var _mui_material_InputAdornment__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @mui/material/InputAdornment */ "./node_modules/@mui/material/InputAdornment/InputAdornment.js");
/* harmony import */ var _mui_icons_material_Fingerprint__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @mui/icons-material/Fingerprint */ "./node_modules/@mui/icons-material/Fingerprint.js");
/* harmony import */ var _mui_icons_material_Send__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @mui/icons-material/Send */ "./node_modules/@mui/icons-material/Send.js");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router/dist/index.js");
/* harmony import */ var _styles_basic_info_module_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./styles/basic-info.module.css */ "./src/components/styles/basic-info.module.css");
/* harmony import */ var _mui_material_Dialog__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @mui/material/Dialog */ "./node_modules/@mui/material/Dialog/Dialog.js");
/* harmony import */ var _mui_material_DialogContent__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @mui/material/DialogContent */ "./node_modules/@mui/material/DialogContent/DialogContent.js");
/* harmony import */ var _mui_material_CircularProgress__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @mui/material/CircularProgress */ "./node_modules/@mui/material/CircularProgress/CircularProgress.js");
/* harmony import */ var _ekyc_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ekyc.scss */ "./src/components/ekyc.scss");
/* harmony import */ var _ekyc_scss__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_ekyc_scss__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _ekyc_module_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ekyc.module.css */ "./src/components/ekyc.module.css");
/* harmony import */ var _home_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./home.css */ "./src/components/home.css");



















// const Footer = React.lazy(() => import("AppFooter/Footer"));

// import AddressInfo from "Products/AddressInfo";




function Ekyc({
  ekycData,
  setEkycData,
  error,
  validate,
  amount,
  setErrMsg,
  basicData,
  setBasicData
}) {
  var formatter = new Intl.NumberFormat("en-US", {
    style: "currency",
    currency: "INR",
    // These options are needed to round to whole numbers if that's what you want.
    minimumFractionDigits: 0 // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)
    //maximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)
  });

  function loadPayment() {
    addPaytmScript(onScriptLoad);
  }
  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    gtag("event", "ekyc_init");
  }, []);
  function onScriptLoad() {
    // document.querySelector(".order-details").style.display = "none";
    var config = {
      root: "#checkout",
      flow: "DEFAULT",
      data: {
        orderId: "sahi-" + sessionStorage.getItem("proposalId"),
        token: localStorage.getItem("txnToken") /* update token value */,
        tokenType: "TXN_TOKEN",
        amount: amount /* update amount */
      },

      merchant: {
        redirect: false
      },
      handler: {
        notifyMerchant: function (eventName, data) {
          console.log("notifyMerchant handler function called");
          console.log("eventName => ", eventName);
          console.log("data => ", data);
        },
        transactionStatus: function (paymentStatus) {
          localStorage.setItem("paymentStatus", JSON.stringify(paymentStatus));
          const messageEl = document.querySelector(".message");
          const messageNode = document.createTextNode(paymentStatus.RESPMSG);
          if (paymentStatus.STATUS == "TXN_SUCCESS") {
            debugger;
            //messageEl.style.display = "none";
            //paytmScript.parentNode.removeChild(paytmScript);
            navigate("../proposal");
          } else {
            setErrMsg(paymentStatus);
          }
          //messageEl.appendChild(messageNode);
          //messageEl.style.display = "block";
        }
      }
    };

    if (window.Paytm && window.Paytm.CheckoutJS) {
      window.Paytm.CheckoutJS.onLoad(function excecuteAfterCompleteLoad() {
        // initialze configuration using init method
        window.Paytm.CheckoutJS.init(config).then(function onSuccess() {
          // after successfully updating configuration, invoke JS Checkout
          window.Paytm.CheckoutJS.invoke();
        }).catch(function onError(error) {
          console.log("error => ", error);
        });
      });
    }
  }
  function addPaytmScript(callback) {
    var s = document.createElement("script");
    s.setAttribute("src", "https://securegw-stage.paytm.in/merchantpgpui/checkoutjs/merchants/NaSqWx02851401972121.js");
    s.onload = callback;
    document.body.appendChild(s);
    setPaytmScript(s);
  }
  function initiateTransaction() {
    const randNum = Math.floor(1000 + Math.random() * 9000);
    const orderId = `PYTM_SAHI_${randNum}`;
    const textNode = document.createTextNode(orderId);
    // document.getElementById("orderId").appendChild(textNode);
    localStorage.setItem("orderId", orderId);
    fetch("https://sahi-backend-dnhiaxv6nq-el.a.run.app/api/v1/sahi/payment/initiate", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        orderId: "sahi-" + sessionStorage.getItem("proposalId"),
        customerId: sessionStorage.getItem("customerId"),
        amount: amount
      })
    }).then(res => res.json()).then(data => {
      localStorage.setItem("txnToken", data.result.body.txnToken);
      handleClickOpen();
      loadPayment();
    }).catch(err => {
      console.log(err);
      setErrMsg(err);
    });
  }
  const loadScript = src => {
    return new Promise(resovle => {
      const script = document.createElement("script");
      script.src = src;
      script.onload = () => {
        resovle(true);
      };
      script.onerror = () => {
        resovle(false);
      };
      document.body.appendChild(script);
    });
  };
  const displayRazorpay = async amount => {
    const res = await loadScript("https://checkout.razorpay.com/v1/checkout.js");
    if (!res) {
      return;
    }
    const options = {
      key: "rzp_test_0AWs9BOIkdhoVj",
      currency: "INR",
      amount: amount * 100,
      name: "Prudential Health Insurance",
      description: "Thanks for purchasing",
      image: "https://www.prudentialplc.com/~/media/Images/P/Prudential-V13/logo/updated-logo.png?h=200&iar=0&w=200",
      theme: {
        color: "#ed1b2e"
      },
      handler: function (response) {
        navigate("../insuranceQuestionnaire");
      },
      prefill: {
        name: "Prudential Health Insurance"
      }
    };
    const paymentObject = new window.Razorpay(options);
    paymentObject.open();
  };
  const navigate = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_5__.useNavigate)();
  function next() {
    validate(1);
    gtag("event", "ekyc_done");
    navigate("../proposal");
  }
  const [open, setOpen] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  const [paytmScript, setPaytmScript] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);
  const handleClickOpen = () => {
    setOpen(true);
  };
  function fileUpload(type, e) {
    debugger;
    setLoader(true);
    var data = new FormData();
    data.append("front_part", e.target.files[0]);
    fetch(`https://sahi-backend-dnhiaxv6nq-el.a.run.app/api/v1/sahi/verify/kyc?customerId=${sessionStorage.getItem("customerId")}`, {
      method: "POST",
      body: data
    }).then(response => {
      return response.json();
    }).then(res => {
      ekycData[type] = res.result.data.id_no;
      setLoader(false);
      setEkycData({
        ...ekycData
      });
      if (res.result.data.id_type == "AADHAAR") {
        let name = res.result.data.name;
        basicData["firstName"] = name.substring(0, name.indexOf(" "));
        basicData["lastName"] = name.substring(name.indexOf(" ") + 1, name.length);
        basicData["dob"] = res.result.data.dob;
        basicData["address"] = res.result.data.address;
        setBasicData({
          ...basicData
        });
      }
    }).catch(error => {
      console.error("Error:", error);
    });
  }
  const handleClose = () => {
    setOpen(false);
  };
  const [isLoader, setLoader] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("section", {
    class: "chat-container"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_mui_material_CircularProgress__WEBPACK_IMPORTED_MODULE_6__["default"], {
    sx: {
      display: isLoader ? "block" : "none"
    },
    style: {
      position: "absolute",
      top: "50%",
      left: "50%",
      color: "#ed1b2e"
    }
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {
    class: "questions-container user_name"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {
    class: " cGIqAI dmGYTj hTEcPe chat-question-inner user_name  text_single "
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("h3", {
    class: " fFoQAK"
  }, "Provide your identity so that we can know you better"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_mui_material_Dialog__WEBPACK_IMPORTED_MODULE_7__["default"], {
    open: open,
    onClose: handleClose
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_mui_material_DialogContent__WEBPACK_IMPORTED_MODULE_8__["default"], {
    id: "checkout"
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react__WEBPACK_IMPORTED_MODULE_0__.Suspense, {
    fallback: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("p", null, "loading...")
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(AddressInfo, null)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {
    className: _styles_basic_info_module_css__WEBPACK_IMPORTED_MODULE_1__["default"].basicDetailContainer
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {
    class: "input-container  text"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_mui_material_TextField__WEBPACK_IMPORTED_MODULE_9__["default"], {
    label: "Aadhar Number",
    variant: "outlined",
    required: true,
    disabled: true,
    fullWidth: true,
    type: "number",
    value: ekycData["aadharEkyc"],
    onBlur: e => {
      validate(2, "aadharEkyc");
    },
    inputProps: {
      autocomplete: "off"
    },
    onChange: e => {
      ekycData["aadharEkyc"] = e.target.value.slice(0, 12);
      setEkycData({
        ...ekycData
      });
    },
    error: error["aadharEkyc"] != null,
    helperText: error["aadharEkyc"] ? error["aadharEkyc"] : ekycData["aadharUpload"] ? `${ekycData["aadharUpload"]} uploaded successfully` : "",
    InputProps: {
      startAdornment: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_mui_material_InputAdornment__WEBPACK_IMPORTED_MODULE_10__["default"], {
        position: "start"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_mui_icons_material_Fingerprint__WEBPACK_IMPORTED_MODULE_11__["default"], null)),
      endAdornment: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_mui_material_IconButton__WEBPACK_IMPORTED_MODULE_12__["default"], {
        color: "primary",
        "aria-label": "upload picture",
        component: "label"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("input", {
        hidden: true,
        onChange: e => {
          fileUpload("aadharEkyc", e);
          // setEkycData({ ...ekycData });
        },

        accept: "image/*,pdf;capture=camera",
        type: "file"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_mui_icons_material_PhotoCamera__WEBPACK_IMPORTED_MODULE_13__["default"], null))
    }
  })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {
    class: "submit-wrap align-center"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_mui_material_Button__WEBPACK_IMPORTED_MODULE_14__["default"], {
    disabled: !(ekycData["aadharEkyc"] != ""),
    onClick: next,
    variant: "contained",
    color: "error",
    endIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_mui_icons_material_Send__WEBPACK_IMPORTED_MODULE_15__["default"], null)
  }, "Next")))));
}

/***/ })

}]);
//# sourceMappingURL=src_components_Ekyc_js.js.map